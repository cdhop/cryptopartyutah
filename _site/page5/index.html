<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <title>CryptoParty - Utah</title>
    <meta name="description" content="Party like it's December 31st, 1983">
    <link rel="canonical" href="http://cryptopartyutah.org/page5/">

    <link rel="icon" type="image/png" href="/favicon.png" />

    <link rel="stylesheet" href="/css/cryptoparty.css">
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!--[if lt IE 9]>
	    <script src="js/html5shiv.js"></script>
	    <script src="js/respond.min.js"></script>
	<![endif]-->
</head>


    <body>
      <nav class="navbar navbar-inverse" role="navigation">
  <div class="navbar-header">
    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
    </button>
    <a class="navbar-brand" href="/">
      <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0" y="0" width="15" height="15" viewBox="0, 0, 255.555, 261.395">
        <g id="Layer_1" transform="translate(-0.207, 27.527)">
          <g>
            <path d="M61.707,104.953 C61.707,65.752 91.604,33.973 128.484,33.973" fill-opacity="0" stroke="#FFF" stroke-width="30"/>
            <path d="M128.484,33.973 C165.364,33.973 195.262,65.752 195.262,104.953" fill-opacity="0" stroke="#FFF" stroke-width="30"/>
          </g>
          <g>
            <path d="M223.221,113.953 C228.063,113.953 231.988,119.326 231.988,125.953 L231.988,221.367 C231.988,227.995 228.063,233.367 223.221,233.367 L33.748,233.367 C28.906,233.367 24.98,227.995 24.98,221.367 L24.98,125.953 C24.98,119.326 28.906,113.953 33.748,113.953 z M88.952,138.484 C69.516,138.484 53.776,154.224 53.776,173.66 C53.776,193.097 69.516,208.836 88.952,208.836 C102.02,208.836 113.404,201.552 119.407,190.9 L133.426,190.754 L144.443,179.663 L152.789,188.155 L161.245,179.663 L169.663,188.155 L178.155,179.517 L186.977,188.375 L187.196,188.302 L201.911,173.367 C203.558,171.647 203.705,170.073 201.838,168.206 L189.978,156.2 L119.187,156.054 C113.038,145.622 101.873,138.484 88.952,138.484 z M73.579,163.631 C78.813,163.631 83.023,167.95 83.023,173.074 C83.023,178.309 78.813,182.591 73.579,182.591 C68.308,182.591 64.135,178.309 64.135,173.074 C64.135,167.95 68.345,163.631 73.579,163.631 z" fill="#FFF"/>
            <path d="M223.221,113.953 C228.063,113.953 231.988,119.326 231.988,125.953 L231.988,221.367 C231.988,227.995 228.063,233.367 223.221,233.367 L33.748,233.367 C28.906,233.367 24.98,227.995 24.98,221.367 L24.98,125.953 C24.98,119.326 28.906,113.953 33.748,113.953 z M88.952,138.484 C69.516,138.484 53.776,154.224 53.776,173.66 C53.776,193.097 69.516,208.836 88.952,208.836 C102.02,208.836 113.404,201.552 119.407,190.9 L133.426,190.754 L144.443,179.663 L152.789,188.155 L161.245,179.663 L169.663,188.155 L178.155,179.517 L186.977,188.375 L187.196,188.302 L201.911,173.367 C203.558,171.647 203.705,170.073 201.838,168.206 L189.978,156.2 L119.187,156.054 C113.038,145.622 101.873,138.484 88.952,138.484 z M73.579,163.631 C78.813,163.631 83.023,167.95 83.023,173.074 C83.023,178.309 78.813,182.591 73.579,182.591 C68.308,182.591 64.135,178.309 64.135,173.074 C64.135,167.95 68.345,163.631 73.579,163.631 z" fill-opacity="0" stroke="#FFF" stroke-width="1"/>
          </g>
      </g>
      </svg>
      CryptoParty - Utah
    </a>
  </div> 
  <div class="navbar-collapse collapse">
    <ul class="nav navbar-nav">
      <li><a href="/links/">Links</a></li>
    </ul>
  </div>
</nav>

      <div id="content">
        <div class="container">
          <div class="home">

  
  <div class="row">

    <header class="post-header">
      <a class="post-link" href="/howto/2014/10/10/setting-up-a-tor-hidden-service/"><h1>Setting up a Tor Hidden Service</h1></a>
      <p class="meta">Oct 10, 2014</p>
    </header>
      
    <article class="post-content">
      <h4 id="why-run-a-hidden-service">Why run a hidden service?</h4>

<p>It has been said that the printing press taught everyone how to read, and that the Internet taught everyone how to write.  While that is debatable, it is certainly true that these technologies 
have dramatically impacted humanity’s ability to express and comsume ideas.</p>

<p>A common approach to obtaining candid information is to provide a way for people to communicate anonymously.  As Oscar Wilde said, “Man is least himself when he talks in his own person. Give 
him a mask, and he will tell you the truth.”  Tor hidden services provide a means for people to communicate anonymously, and speak with candor.</p>

<h4 id="what-do-you-need-to-run-a-hidden-service">What do you need to run a hidden service?</h4>

<p>While you can run a hidden service on any computer, and nearly any operating system, it is recommended (for security reasons) to use open source software.  The reason is that open source software
can be audited, and changed by the community that uses it, and is therefore more trustworthy than proprietary software (where they may have be beholden to other groups and interests).
This tutorial describes how to use software provided by the Debian and Tor Projects to create a hidden service.</p>

<p>It is generally a good idea (for availablity) to place the service on a 
system with a ‘always on’ connection to the Internet.  You should be mindful of any acceptable use policies if you plan on hosting the service with a provider.</p>

<h4 id="step-1-install-tor">Step 1: Install Tor</h4>

<p>Anyone who has spent even a limited amount of time with debian-based systems are familiar with its software package management system.  Instead of installing Tor from source (which is possible), 
I prefer to use package-management whenever possible (easier to update and maintain).</p>

<p>While Tor is available from the default debian project repositories, it is usually not as up to date as from the Tor Project repositories.  So we will first install the Tor Project’s repositories into the Debian package management system.</p>

<p>The default repositories are found in the /etc/apt/sources.list file.  You can add the Tor Project’s repository by adding the following line to the file:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>deb     http://deb.torproject.org/torproject.org &lt;DISTRIBUTION&gt; main
</code></pre>
</div>

<p>You should replace the <distribution> label with the codename for your version of Debian (for example wheezy for Debian 7.x).</distribution></p>

<p>The packages are signed using the Tor Project’s GPG Keys.  So we will need to add the key to Apt in order to use the repository.  Use the following commands:</p>

<div class="highlighter-rouge"><pre class="highlight"><code> # gpg --keyserver keys.gnupg.net --recv 886DDD89
 # gpg --export A3C4F0F979CAA22CDBA8F512EE8CBC9E886DDD89 | sudo apt-key add -
</code></pre>
</div>

<p>Now we need to update apt now that we have added the Tor project’s repositories:</p>

<div class="highlighter-rouge"><pre class="highlight"><code> # apt-get update
</code></pre>
</div>

<p>With the repository updated, we will install a package which makes keepig the Tor project’s signing keys up to date:</p>

<div class="highlighter-rouge"><pre class="highlight"><code> # apt-get install deb.torproject.org-keyring
</code></pre>
</div>

<p>Finally,  we install Tor:</p>

<div class="highlighter-rouge"><pre class="highlight"><code> # apt-get install tor
</code></pre>
</div>

<p>You should now have the Tor service running on your system.  Time for the next step.</p>

<h4 id="step-2-install-a-web-server">Step 2: Install a Web Server</h4>

<p>In most cases, a hidden service is just a website accessible through Tor.  As with any other website, we will need a webserver.  Any webserver will do the job.</p>

<p>I would suggest configuring the webserver to only listen to requests from the local server.  The reason is that this will force all interaction with the server through the Tor network.</p>

<p>Because there are many different webservers, and several tutorials available, I will not go into any further details on how to configure them.</p>

<p>Note: Your hidden service can be any service commonly available on the Internet (ssh, IRC, etc).</p>

<h4 id="step-3-configure-the-hidden-service">Step 3: Configure the Hidden Service</h4>

<p>Now that you have Tor and a webserver installed and running, its time to configure the hidden service.  In order to do this, we will need to reconfigure the tor service;  The tor service is configured
using the /etc/tor/torrc file.  Inside the torrc file there is a section for ‘location-hidden services.’  There will be some example configurations for hidden services (commented out).  They will look
similar to this (uncomment them):</p>

<div class="highlighter-rouge"><pre class="highlight"><code># HiddenServiceDir /var/lib/tor/hidden_service/
# HiddenServicePort 80 127.0.0.1:8080
</code></pre>
</div>

<p>The HiddenServiceDir directive points to the path where the ‘pivate_key’ and the ‘hostname’ files for the hidden service exist.  The ‘pivate_key’ is a secret which you should protect from disclosure, and
the ‘hostname’ file has the .onion address that people will use to access the hidden service.  Both of theses files will be generated by the tor service. It is important that the ‘debian-tor’ user have 
full permissions to this directory.  I would suggest placing the hidden service directory in ‘/var/lib/tor/’.</p>

<p>The HiddenServicePort directive identifies the port the service will be accessible on inside the tor network, and the local address and port of the service.</p>

<p>After modifying the torrc file, and creating the directory, you will need to restart the tor service in order to make the hidden service active.</p>

<h4 id="conclusion">Conclusion</h4>

<p>You should now have a working Tor hidden-service (the address for your hidden service can be found in the ‘hostname’ file mentioned above).</p>

<hr />

<h4 id="references">Reference(s):</h4>

<p><a href="https://www.torproject.org/docs/tor-hidden-service.html.en">Configuring Hidden Services for Tor</a></p>

    </article>
  </div>
  

  
  <div class="row">
    <hr/>
    
    <nav>
      <ul class="pager">
	
	  <li><a href="/page4">
            <span class="glyphicon glyphicon-triangle-left" aria-hidden="true"></span> Previous
	  </a></li>
	
	
	  <li><a href="/page6">
	    Next <span class="glyphicon glyphicon-triangle-right" aria-hidden="true"></span>
	  </a></li>
	
      </ul>
    </nav>

  </div>
  
</div>

        </div>
      </div>

      <div id="about">
  <div class="container">
    <div class="row">
      <div class="col-12">
	    <h2>About</h2>
	    <p>We are focused on online privacy advocacy and education.  We welcome anyone interested, or concerned with how technology impacts privacy.  We plan on providing education and support for using cryptography and good security practices. </p>
	  </div>
	</div>
  </div>
</div>
      <footer>
  <div class="container">
    <div class="row">

      <div class="col-sm-4">
        <h4>Contact</h4>
        <ul class="list-unstyled">
          <li><a href="mailto:cdhop@disquietingcandor.net">cdhop@disquietingcandor.net</a></li>
          <li><a href="/files/C8670D8D.asc">GPG/PGP Key</a></li>
        </ul>
      </div>

      <div class="col-sm-2">
        <h4>Resources</h4>
        <ul class="list-unstyled">
          <li>
            <a href="https://github.com/cdhop/cryptopartyutah">
              <span class="icon github">
                <svg version="1.1" width="16px" height="16px" class="github-icon-svg" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                   viewBox="0 0 16 16" enable-background="new 0 0 16 16" xml:space="preserve">
                  <path fill-rule="evenodd" clip-rule="evenodd" fill="#000" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761
                  c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32
                  c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472
                  c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037
                  C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65
                  c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261
                  c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082
                  c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129
                  c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>
              <span class="username">GitHub</span>
            </a>
          </li>
          <li>
            <a href="/feed.xml">
              <span>
                <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="16px" height="16px" id="RSSicon" viewBox="0 0 256 256">
                  <defs>
                    <linearGradient x1="0.085" y1="0.085" x2="0.915" y2="0.915" id="RSSg">
                    <stop  offset="0.0" stop-color="#E3702D"/><stop  offset="0.1071" stop-color="#EA7D31"/>
                    <stop  offset="0.3503" stop-color="#F69537"/><stop  offset="0.5" stop-color="#FB9E3A"/>
                    <stop  offset="0.7016" stop-color="#EA7C31"/><stop  offset="0.8866" stop-color="#DE642B"/>
                    <stop  offset="1.0" stop-color="#D95B29"/>
                    </linearGradient>
                  </defs>
                  <rect width="256" height="256" rx="55" ry="55" x="0"  y="0"  fill="#CC5D15"/>
                  <rect width="246" height="246" rx="50" ry="50" x="5"  y="5"  fill="#F49C52"/>
                  <rect width="236" height="236" rx="47" ry="47" x="10" y="10" fill="url(#RSSg)"/>
                  <circle cx="68" cy="189" r="24" fill="#FFF"/>
                  <path d="M160 213h-34a82 82 0 0 0 -82 -82v-34a116 116 0 0 1 116 116z" fill="#FFF"/>
                  <path d="M184 213A140 140 0 0 0 44 73 V 38a175 175 0 0 1 175 175z" fill="#FFF"/>
                </svg>
              </span>
              <span>RSS</span>
            </a>
          </li>
        </ul>
      </div>

      <div class="col-sm-6">
        <h4>Darknet</h4>
        <ul class="list-unstyled">
          <li>Hidden Service (Tor): <a href="http://5i3gqg3jz7zs6x62.onion">5i3gqg3jz7zs6x62.onion</a></li>
          <li>Eepsite (i2p): <a href="http://utah.cryptoparty.i2p">utah.cryptoparty.i2p</a></li>
        </ul>
      </div>

    </div>
  </div>
</footer>

      <script src="/js/jquery.min.js"></script>
      <script src="/js/bootstrap.min.js"></script>
    </body>
</html>